@{
    ViewBag.Title = "Home Page";
}
<style>
    body {
        /*background-image: url(Content/Dulce/Dulceria.jpg);*/
    }

    #ele {
        margin: 0 auto;
        padding: 20px 0;
    }

    table {
        margin: 0 auto;
    }

    .rojo {
        background-color: red;
        background-image: url(Content/Dulce/rojo.jpg);
    }

    .azul {
        background-color: blue;
        background-image: url(Content/Dulce/azul.jpg);
    }

    .amarillo {
        background-color: yellow;
        background-image: url(Content/Dulce/amarillo.jpg);
    }

    .naranja {
        background-color: orange;
        background-image: url(Content/Dulce/naranja.jpg);
    }

    .verde {
        background-color: green;
        background-image: url(Content/Dulce/verde.jpg);
    }

    td {
        width: 60px;
        height: 60px;
        text-align: left;
        color: #757d5f;
        font-size: 8px;
        border: solid 1px #313738;
        background-color: #07889B;
        border-radius: 4px;
            }

        td:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }

    #tableCandy {
        margin-top: 0%;
    }
</style>

<div class="row">
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                Candysdsd
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li></li>
                    <li></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container body-content">
        <div>
            <span id="contador" class="verde">contador</span>
        </div>
        <div id="container">
        </div>
        <footer>
            <p></p>
        </footer>
    </div>

    @section Scripts {
    <script type="text/javascript">

        $(document).ready(function () {

            var contToques = 0;
            var movimiento1 = -1;
            var movimiento2 = -1;
            var apiURL = "http://localhost:64829/api/";
            var partida = -1;

           $.post(apiURL + "Partida", { id: '0' })
                        .done(function (data) {
                            partida = data.id;
                            Paint(data);
                        }).fail(function(error) { alert(error.responseJSON) });
            


            $("body").on("click", "td", function () {

                if (movimiento1 == $(this).attr("numero") || movimiento2 == $(this).attr("numero")) {
                    return;
                }

                if (contToques == 0) {
                    movimiento1 = $(this).attr("numero");
                    contToques++;
                }
                else {
                    contToques++;
                    movimiento2 = $(this).attr("numero");
                }
                $("#contador").text(50 - contToques)
                if (movimiento2 > -1) {

                    $.ajax({
                        url: apiURL + "Partida/" + partida,
                        type: 'PUT',
                        data: { 'usuario': 0, 'movimiento1': movimiento1, 'movimiento2': movimiento2 },
                        success: function (data) {
                            Paint(data);
                            movimiento1 = -1;
                            movimiento2 = -1;
                            contToques = 0;

                        }
                    });
                }
            });

        });


        function Paint(data) {
            $("#container").html("");
            var table = "";
            var color = "red";
            table += "<table id='tableCandy'>";

            for (var i = 0; i < data.dulces.length; i++) {
                if (i == 0 || i == 9 || i == 18 || i == 27 || i == 36 || i == 45 || i == 54 || i == 63)
                    table += "<tr>";

                if (data.dulces[i].color == 0)
                    color = "rojo";

                if (data.dulces[i].color == 1)
                    color = "azul";

                if (data.dulces[i].color == 2)
                    color = "amarillo";

                if (data.dulces[i].color == 3)
                    color = "naranja";

                if (data.dulces[i].color == 4)
                    color = "verde";

                table += "<td id='" + data.dulces[i].id + "' numero='" + data.dulces[i].id + "' class='" + color + "'   ></td>";
                if (i == 8 || i == 17 || i == 26 || i == 35 || i == 44 || i == 53 || i == 62 || i == 71)
                    table += "</tr>";
            }
            table += "</table>";
            $("#container").html(table);
        }
    </script>
          }  
</div>